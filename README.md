TODO:
* Handle States correctly (not done now)
* Error handling

